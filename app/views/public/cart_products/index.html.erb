<div class="container">
  <div class="row mt-4">
    <div class="col-10 offset-1">
      <h4>ショッピングカート</h4>
      <% if @member_cart_products.exists? %>
      <div class="text-right">
        <button class="btn btn-danger ">
          <%= link_to "カートを空にする",public_cart_product_destroy_path, method: :delete, class: "text-white" %>
        </button>
      </div>
      <table class="table table-hover mt-5">
        <thead>
          <tr>
            <th>商品名</th>
            <th>単価（税込）</th>
            <th>数量</th>
            <th>小計</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <% @member_cart_products.each do |cart|  %>
          <tr>
            <td><%= cart.product.name %></td>
            <td>
              <% @product_price = cart.product.tax_out_price * 1.1 %>
              <%= @product_price.floor  %>円
            </td>
            <td>
              <%= form_with model: cart, url: public_cart_product_path(cart),method: :patch ,local: true do |f| %>
               <%= f.select :quantity,[["1","1"],["2","2"],["3","3"],["4","4"],["5","5"]] ,include_blank: "個数選択" ,class: "form-select"%>
                <%= f.hidden_field :id, :value => cart %>
                <%= f.hidden_field :member_id, :value => current_member.id %>
              <button class="btn btn-success btn-sm">変更<% f.submit %></button>
              <% end %>
            </td>
            <td>
              <% @total = @product_price * cart.quantity.to_i %>
              <%= @total.floor %>
            </td>
            <td>
              <button class="btn btn-danger">
                <%= link_to "削除する", public_cart_product_path(cart),method: :delete , class: "text-white"%>
              </button>
            </td>
          </tr>
          <% end %>
        </tbody>
      </table>
      <div class="mt-4">
        <button class="btn btn-primary">
          <%= link_to  "買い物を続ける", public_products_path ,class: "text-white" %></button>
      </div>
      <div class="text-center my-4">
        <button class="btn btn-success">情報入力に進む</button>
      </div>
      <% else %>
      <p>商品一覧から商品をカートに入れてください。</p>
     <% end %>
    </div>
  </div>
</div>